<app-adminheader></app-adminheader>

<div class="bg-blow-50 min-h-screen px-10 py-8">

  <h1 class="text-3xl font-bold text-center text-gray-800 mb-12">
    GestiÃ³n de Solicitudes
  </h1>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">

    <div>

      <h2 class="text-2xl font-bold text-center mb-1 text-gray-800">
        Solicitudes Pendientes
      </h2>

      <p class="text-center text-gray-500 mb-6 font-medium">
        {{ pendientes.length }} solicitudes esperando aprobaciÃ³n
      </p>

      <div *ngIf="pendientes.length === 0"
        class="text-center text-gray-500 mt-10 text-lg">
        ðŸŽ‰ Â¡No hay solicitudes pendientes!
      </div>

      <div *ngFor="let s of pendientes.slice(indiceInicioPendientes, indiceInicioPendientes + 5)"
        class="bg-white mx-auto mb-6 p-5 rounded-2xl shadow-lg border-l-4 max-w-md border-red-500">

        <div class="flex items-center gap-4">
          <img src="assets/proyector.png"
            class="w-16 h-16 rounded-xl object-cover shadow-sm" />

          <div class="flex-1">
            <h3 class="font-semibold text-lg text-gray-800">
              {{ s.itemName || ('Item ID ' + s.itemId) }}
            </h3>
            <p class="text-sm text-gray-600 mt-1">
              Usuario: {{ s.userName || ('Usuario ID ' + s.userId) }}
            </p>
            <p class="text-sm text-gray-400 mt-1">
              Fecha: {{ s.fechaSolicitud | date:'dd/MM/yyyy' }}
            </p>
          </div>
        </div>

        <div class="flex justify-between gap-4 mt-6">
          <button (click)="aprobar(s)"
            class="flex-1 bg-green-600 text-white py-2 rounded-full hover:bg-green-700 transition-all shadow-md">
            âœ” Aprobar
          </button>

          <button (click)="rechazar(s)"
            class="flex-1 bg-red-600 text-white py-2 rounded-full hover:bg-red-700 transition-all shadow-md">
            âœ– Rechazar
          </button>
        </div>
      </div>

      <div *ngIf="pendientes.length > 5" class="flex justify-center items-center mt-8 gap-4">
        <button [disabled]="indiceInicioPendientes === 0" (click)="anteriorPendientes()"
          class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>

        <span class="text-gray-600 font-medium text-sm">
          {{ (indiceInicioPendientes / 5) + 1 }} / {{ totalPaginasPendientes }}
        </span>

        <button [disabled]="indiceInicioPendientes + 5 >= pendientes.length" (click)="siguientePendientes()"
          class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
      </div>

    </div>

    <div>

      <h2 class="text-2xl font-bold text-center mb-1 text-gray-800">
        Historial de Solicitudes
      </h2>

      <p class="text-center text-gray-500 mb-6 font-medium">
        {{ historial.length }} solicitudes procesadas
      </p>

      <div *ngIf="historial.length === 0"
        class="text-center text-gray-500 mt-10 text-lg">
        ðŸ“„ AÃºn no hay historial de solicitudes.
      </div>

      <div *ngFor="let s of historial.slice(indiceInicioHistorial, indiceInicioHistorial + 5)"
        class="bg-white mx-auto mb-6 p-5 rounded-2xl shadow-lg flex items-start gap-4 max-w-md border-l-4"
        [ngClass]="{
          'border-green-500': s.estado === 'Aprobada',
          'border-red-500': s.estado === 'Rechazada'
        }">

        <img src="assets/laptop.png"
          class="w-16 h-16 rounded-xl object-cover shadow-sm" />

        <div class="flex-1">
          <h4 class="text-lg font-semibold text-gray-800">
            {{ s.itemName || ('Item ID ' + s.itemId) }}
          </h4>

          <span class="inline-block px-3 py-1 text-xs rounded-full font-medium mt-1"
            [ngClass]="{
              'bg-green-100 text-green-700': s.estado === 'Aprobada',
              'bg-red-100 text-red-700': s.estado === 'Rechazada'
            }">
            {{ s.estado }}
          </span>

          <p class="text-sm text-gray-500 mt-2">
            Usuario: {{ s.userName || ('Usuario ID ' + s.userId) }}
          </p>

          <p class="text-sm text-gray-400">
            Solicitado: {{ s.fechaSolicitud | date:'dd/MM/yyyy' }}
          </p>

          <p *ngIf="s.fechaRespuesta" class="text-sm text-gray-400">
            Respondido: {{ s.fechaRespuesta | date:'dd/MM/yyyy' }}
          </p>
        </div>

      </div>

      <div *ngIf="historial.length > 5" class="flex justify-center items-center mt-8 gap-4">
        <button [disabled]="indiceInicioHistorial === 0" (click)="anteriorHistorial()"
          class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>

        <span class="text-gray-600 font-medium text-sm">
          {{ (indiceInicioHistorial / 5) + 1 }} / {{ totalPaginasHistorial }}
        </span>

        <button [disabled]="indiceInicioHistorial + 5 >= historial.length" (click)="siguienteHistorial()"
          class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
      </div>

    </div>
  </div>
</div>